<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechFlow - Debug Version</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: #fff; }
        .container { max-width: 800px; margin: 0 auto; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #2d5a2d; border: 1px solid #4CAF50; }
        .error { background: #5a2d2d; border: 1px solid #ff6b6b; }
        .warning { background: #5a5a2d; border: 1px solid #ffeb3b; }
        .loading { background: #2d2d5a; border: 1px solid #2196F3; }
        button { background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #45a049; }
        .article { border: 1px solid #333; margin: 10px 0; padding: 15px; border-radius: 8px; }
        .timestamp { color: #888; font-size: 0.9em; }
        .source { color: #4CAF50; font-weight: bold; }
        pre { background: #333; padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ TechFlow Debug Console</h1>
        <p>This page helps debug loading issues with the main site.</p>
        
        <div class="status loading" id="status">
            ðŸ”„ Initializing debug console...
        </div>
        
        <button onclick="testMainSite()">Test Main Site Loading</button>
        <button onclick="testAPIs()">Test Individual APIs</button>
        <button onclick="showFallbackContent()">Show Fallback Content</button>
        <button onclick="clearLogs()">Clear Logs</button>
        
        <div id="logs"></div>
        <div id="content"></div>
    </div>

    <script>
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            logs.push({ timestamp, message, type });
            updateLogs();
        }
        
        function updateLogs() {
            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML = '<h3>ðŸ“‹ Debug Logs</h3>' + 
                logs.slice(-10).map(log => 
                    `<div class="status ${log.type}">
                        [${log.timestamp}] ${log.message}
                    </div>`
                ).join('');
        }
        
        function clearLogs() {
            logs = [];
            document.getElementById('logs').innerHTML = '';
            document.getElementById('content').innerHTML = '';
        }
        
        async function testMainSite() {
            log('ðŸ”„ Testing main site loading process...', 'loading');
            
            try {
                // Simulate the main site's loading process
                log('Step 1: Initializing TechFlow class', 'info');
                
                // Test fallback articles first
                log('Step 2: Creating fallback articles', 'info');
                const fallbackArticles = createFallbackArticles();
                log(`âœ… Created ${fallbackArticles.length} fallback articles`, 'success');
                
                // Test live news loading
                log('Step 3: Testing live news loading with timeout', 'info');
                const startTime = Date.now();
                
                try {
                    const liveArticles = await Promise.race([
                        fetchLiveNews(),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 8000))
                    ]);
                    
                    const loadTime = Date.now() - startTime;
                    log(`âœ… Live news loaded in ${loadTime}ms: ${liveArticles.length} articles`, 'success');
                    
                    displayArticles([...liveArticles, ...fallbackArticles].slice(0, 8));
                    
                } catch (error) {
                    const loadTime = Date.now() - startTime;
                    log(`âš ï¸ Live news failed after ${loadTime}ms: ${error.message}`, 'warning');
                    log('ðŸ“° Using fallback articles instead', 'info');
                    
                    displayArticles(fallbackArticles.slice(0, 8));
                }
                
                log('âœ… Main site loading test completed', 'success');
                
            } catch (error) {
                log(`âŒ Main site test failed: ${error.message}`, 'error');
            }
        }
        
        async function testAPIs() {
            log('ðŸ”„ Testing individual APIs...', 'loading');
            
            const apis = [
                { name: 'Hacker News', test: testHackerNews },
                { name: 'Dev.to', test: testDevTo },
                { name: 'GitHub', test: testGitHub }
            ];
            
            for (const api of apis) {
                try {
                    log(`Testing ${api.name}...`, 'info');
                    const startTime = Date.now();
                    const result = await api.test();
                    const loadTime = Date.now() - startTime;
                    log(`âœ… ${api.name}: ${result.length} articles in ${loadTime}ms`, 'success');
                } catch (error) {
                    log(`âŒ ${api.name}: ${error.message}`, 'error');
                }
            }
        }
        
        async function testHackerNews() {
            const response = await fetch('https://hacker-news.firebaseio.com/v0/topstories.json');
            if (!response.ok) throw new Error('API request failed');
            const storyIds = await response.json();
            return storyIds.slice(0, 5);
        }
        
        async function testDevTo() {
            const response = await fetch('https://dev.to/api/articles?tag=javascript&per_page=5');
            if (!response.ok) throw new Error('API request failed');
            const articles = await response.json();
            return articles;
        }
        
        async function testGitHub() {
            const response = await fetch('https://api.github.com/search/repositories?q=javascript&sort=stars&per_page=5');
            if (!response.ok) throw new Error('API request failed');
            const data = await response.json();
            return data.items || [];
        }
        
        async function fetchLiveNews() {
            // Simplified version of the main site's fetch function
            const results = await Promise.allSettled([
                testHackerNews(),
                testDevTo(),
                testGitHub()
            ]);
            
            let totalArticles = 0;
            results.forEach((result, index) => {
                const apiNames = ['Hacker News', 'Dev.to', 'GitHub'];
                if (result.status === 'fulfilled') {
                    totalArticles += result.value.length;
                    log(`âœ… ${apiNames[index]}: ${result.value.length} items`, 'success');
                } else {
                    log(`âŒ ${apiNames[index]}: Failed`, 'error');
                }
            });
            
            return Array(totalArticles).fill(null).map((_, i) => ({
                id: `live-${i}`,
                title: `Live Article ${i + 1}`,
                source: 'Live API',
                timestamp: new Date().toISOString()
            }));
        }
        
        function createFallbackArticles() {
            const now = new Date();
            return [
                {
                    id: 'fallback-1',
                    title: 'Apple Unveils Revolutionary iPhone 16 Pro with Advanced AI Features',
                    source: 'TechCrunch',
                    timestamp: new Date(now - 1 * 60 * 60 * 1000).toISOString()
                },
                {
                    id: 'fallback-2',
                    title: 'Google Announces Major Android 15 Update with Enhanced Privacy',
                    source: 'The Verge',
                    timestamp: new Date(now - 2 * 60 * 60 * 1000).toISOString()
                },
                {
                    id: 'fallback-3',
                    title: 'Microsoft Copilot Integration Transforms Developer Productivity',
                    source: 'Hacker News',
                    timestamp: new Date(now - 3 * 60 * 60 * 1000).toISOString()
                },
                {
                    id: 'fallback-4',
                    title: 'OpenAI Releases GPT-5: Next Generation AI Model',
                    source: 'Dev.to',
                    timestamp: new Date(now - 4 * 60 * 60 * 1000).toISOString()
                }
            ];
        }
        
        function showFallbackContent() {
            log('ðŸ“° Displaying fallback content...', 'info');
            const articles = createFallbackArticles();
            displayArticles(articles);
            log(`âœ… Displayed ${articles.length} fallback articles`, 'success');
        }
        
        function displayArticles(articles) {
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = '<h3>ðŸ“° Articles</h3>' + 
                articles.map(article => `
                    <div class="article">
                        <div class="source">${article.source}</div>
                        <h4>${article.title}</h4>
                        <div class="timestamp">${getTimeAgo(new Date(article.timestamp))}</div>
                    </div>
                `).join('');
        }
        
        function getTimeAgo(date) {
            const now = new Date();
            const diffInMinutes = Math.floor((now - date) / (1000 * 60));
            
            if (diffInMinutes < 1) return 'Just now';
            if (diffInMinutes < 60) return `${diffInMinutes}m ago`;
            
            const diffInHours = Math.floor(diffInMinutes / 60);
            if (diffInHours < 24) return `${diffInHours}h ago`;
            
            const diffInDays = Math.floor(diffInHours / 24);
            if (diffInDays === 1) return 'Yesterday';
            if (diffInDays < 7) return `${diffInDays}d ago`;
            
            return date.toLocaleDateString();
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            log('ðŸš€ Debug console initialized', 'success');
            document.getElementById('status').innerHTML = 'âœ… Debug console ready';
            document.getElementById('status').className = 'status success';
        });
    </script>
</body>
</html>